í…ì„œí”Œë¡œìš°(TensorFlow)
02
02 í…ì„œí”Œë¡œìš°(TensorFlow)
ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„ì„ ìœ„í•´ í•™ìŠµí•´ì•¼ í•  ë¶„ì•¼
ë”¥ëŸ¬ë‹ ëª¨ë¸(íŒŒì´ì¬) + ì¢‹ì€ ì—°ì‚° ì¥ì¹˜(í•˜ë“œì›¨ì–´) + ì—°ì‚° ì¥ì¹˜ ì œì–´(C/C++)
ë“±ë“± ë°°ìš¸ ê²ƒì´ ë„ˆë¬´ ë§ìŒ
íŒŒì´ì¬ í•˜ë“œì›¨ì–´ C/C++
02 í…ì„œí”Œë¡œìš°(TensorFlow)
í”„ë ˆì„ì›Œí¬ë¥¼ í†µí•œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„
ë”¥ëŸ¬ë‹ ëª¨ë¸ì˜ í•™ìŠµê³¼ ì¶”ë¡ ì„ ìœ„í•œ í”„ë¡œê·¸ë¨
ë”¥ëŸ¬ë‹ ëª¨ë¸ì„ ì‰½ê²Œ êµ¬í˜„, ì‚¬ìš©ê°€ëŠ¥
02 í…ì„œí”Œë¡œìš°(TensorFlow)
í”„ë ˆì„ì›Œí¬ ì„ íƒí•˜ê¸°
ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ê³ , ë¹ ë¥¸ ì„±ì¥ìœ¨ì„ ê°€ì§„ í”„ë ˆì„ì›Œí¬
TensorFlow(í…ì„œí”Œë¡œìš°) í™œìš©
Deep Learning Framework
Six-Month Growth Scores 2019
83
TensorFlow PyTorch Keras FastAI
Framework
Score
66
47
10
80
60
40
20
0
02 í…ì„œí”Œë¡œìš°(TensorFlow)
í…ì„œí”Œë¡œìš°(TensorFlow)
ìœ ì—°í•˜ê³ , íš¨ìœ¨ì ì´ë©°, í™•ì¥ì„± ìˆëŠ” ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬
ëŒ€í˜• í´ëŸ¬ìŠ¤í„° ì»´í“¨í„°ë¶€í„° ìŠ¤ë§ˆíŠ¸í°ê¹Œì§€ ë‹¤ì–‘í•œ ë””ë°”ì´ìŠ¤ì—ì„œ ë™ì‘
02 í…ì„œí”Œë¡œìš°(TensorFlow)
í…ì„œ(Tensor)
1-D Tensor 2-D Tensor 3-D Tensor
Tensor = Multidimensional Arrays = Data
ë”¥ëŸ¬ë‹ì—ì„œ í…ì„œëŠ” ë‹¤ì°¨ì› ë°°ì—´ë¡œ ë‚˜íƒ€ë‚´ëŠ” ë°ì´í„°ë¥¼ ì˜ë¯¸
â€¦
02 í…ì„œí”Œë¡œìš°(TensorFlow)
í”Œë¡œìš°(Flow)
í”Œë¡œìš°ëŠ” ë°ì´í„°ì˜ íë¦„ì„ ì˜ë¯¸
í…ì„œí”Œë¡œìš°ì—ì„œ ê³„ì‚°ì€ ë°ì´í„° í”Œë¡œìš° ê·¸ë˜í”„ë¡œ ìˆ˜í–‰
ê·¸ë˜í”„ë¥¼ ë”°ë¼ ë°ì´í„°ê°€ ë…¸ë“œë¥¼ ê±°ì³ í˜ëŸ¬ê°€ë©´ì„œ ê³„ì‚°
3
Î£
í…ì„œ(Tensor)
3
í…ì„œ(Tensor)
+
ë…¸ë“œ(Node)
3+
3
í…ì„œ(Tensor)
02 í…ì„œí”Œë¡œìš°(TensorFlow)
í…ì„œ+í”Œë¡œìš°
ë”¥ëŸ¬ë‹ì—ì„œ ë°ì´í„°ë¥¼ ì˜ë¯¸í•˜ëŠ” í…ì„œ(tensor)ì™€
ë°ì´í„° í”Œë¡œìš° ê·¸ë˜í”„ë¥¼ ë”°ë¼ ì—°ì‚°ì´ ìˆ˜í–‰ë˜ëŠ” í˜•íƒœ(Flow)ì˜ í•©
feature label
12, 13, 33 0
32, 25, 53 1
1, 36, 100 5
â€¦
â€¦
Tensor Flow
ğ‘¥1
ğ‘¥ğ‘›
â€¦
Input Layer
â€¦
1 hidden
layer
â€¦
1 hidden
layer
Output Layer
â€¦ â€¦
â€¦
+
02 í…ì„œí”Œë¡œìš°(TensorFlow)
í…ì„œí”Œë¡œìš° version.1
ì´ ì „ í…ì„œí”Œë¡œìš° 1.X ì—ì„œëŠ” ê³„ì‚°ì„ ìœ„í•´
ê·¸ë˜í”„ ë° ì„¸ì…˜(Session) ìƒì„± í•„ìš”
ğ‘¥
ğ‘¥
+
+
ğ‘¥
ğ‘¦ 2
Variable
Constant
Operation
02 í…ì„œí”Œë¡œìš°(TensorFlow)
ì§ê´€ì ì¸ ì¸í„°í˜ì´ìŠ¤ì˜ í…ì„œí”Œë¡œìš° version.2
2019ë…„ 9ì›”ë¶€í„° ë°°í¬ëœ 2.0 ë²„ì „ ì´í›„ë¶€í„°ëŠ” ì¦‰ì‹œ ì‹¤í–‰(Eager Execution)
ê¸°ëŠ¥ì„ í†µí•´ ê³„ì‚° ê·¸ë˜í”„, ì„¸ì…˜ ìƒì„± ì—†ì´ ì‹¤í–‰ ê°€ëŠ¥
Confidential all right reserved
í…ì„œí”Œë¡œìš° ê¸°ì´ˆ ì‚¬ìš©ë²•
03
03
í…ì„œ ë‹¤ë¤„ë³´ê¸°
ë‹¤ì–‘í•œ íƒ€ì…ì˜ ê¸°ë³¸ í…ì„œ ì•Œì•„ë³´ê¸°
í…ì„œí”Œë¡œìš° ê¸°ì´ˆ ì‚¬ìš©ë²•
Constant
Tensor
Sequence
Tensor
ìƒìˆ˜ í…ì„œ ì‹œí€€ìŠ¤ í…ì„œ
Variable
Tensor
ë³€ìˆ˜ í…ì„œ
ìƒìˆ˜ í…ì„œ(Constant Tensor)
03
Example
import tensorflow as tf
tf.constant(value, dtype= None, shape= None, name= â€˜Constâ€™)
í…ì„œí”Œë¡œìš° ê¸°ì´ˆ ì‚¬ìš©ë²•
import tensorflow as tf
# ìƒìˆ˜í˜• í…ì„œ ìƒì„±
tensor_a = tf.constant(value, dtype=None, shape=None, name=None)
value : ë°˜í™˜ë˜ëŠ” ìƒìˆ˜ê°’ shape : Tensorì˜ ì°¨ì›
dtype : ë°˜í™˜ë˜ëŠ” Tensor íƒ€ì… name : í…ì„œ ì´ë¦„
ë‹¤ì–‘í•œ ìƒìˆ˜ í…ì„œ ìƒì„±í•˜ê¸°
03
Example
import tensorflow as tf
tf.constant(value, dtype= None, shape= None, name= â€˜Constâ€™)
í…ì„œí”Œë¡œìš° ê¸°ì´ˆ ì‚¬ìš©ë²•
import tensorflow as tf
# ëª¨ë“  ì›ì†Œ ê°’ì´ 0ì¸ í…ì„œ ìƒì„±
tensor_b = tf.zeros(shape, dtype=tf.float32, name=None)
# ëª¨ë“  ì›ì†Œ ê°’ì´ 1ì¸ í…ì„œ ìƒì„±
tensor_c = tf.ones(shape, dtype=tf.float32, name=None)
ì‹œí€€ìŠ¤ í…ì„œ(Sequence Tensor)
03
Example
import tensorflow as tf
tf.constant(value, dtype= None, shape= None, name= â€˜Constâ€™)
í…ì„œí”Œë¡œìš° ê¸°ì´ˆ ì‚¬ìš©ë²•
import tensorflow as tf
# startì—ì„œ stopê¹Œì§€ ì¦ê°€í•˜ëŠ” num ê°œìˆ˜ ë°ì´í„°ë¥¼ ê°€ì§„ í…ì„œ ìƒì„±
tensor_d = tf.linspace(start, stop, num, name=None)
start : ì‹œì‘ ê°’ stop : ë ê°’
num : ìƒì„±í•  ë°ì´í„° ê°œìˆ˜ name : í…ì„œì˜ ì´ë¦„
ì‹œí€€ìŠ¤ í…ì„œ(Sequence Tensor)
03
Example
import tensorflow as tf
tf.constant(value, dtype= None, shape= None, name= â€˜Constâ€™)
í…ì„œí”Œë¡œìš° ê¸°ì´ˆ ì‚¬ìš©ë²•
import tensorflow as tf
# startì—ì„œ limitê¹Œì§€ deltaì”© ì¦ê°€í•˜ëŠ” ë°ì´í„°ë¥¼ ê°€ì§„ í…ì„œ ìƒì„±
tensor_e = tf.range(start, limit, delta, name=None)
start : ì‹œì‘ ê°’ limit : ë ê°’
delta : ì¦ê°€ëŸ‰ name : í…ì„œì˜ ì´ë¦„
ë³€ìˆ˜ í…ì„œ(Variable Tensor)
03
Example
import tensorflow as tf
tf.constant(value, dtype= None, shape= None, name= â€˜Constâ€™)
í…ì„œí”Œë¡œìš° ê¸°ì´ˆ ì‚¬ìš©ë²•
import tensorflow as tf
# ë³€ìˆ˜í˜• í…ì„œ ìƒì„±
tensor_f = tf.Variable(initial_value=None, dtype= None, name= None )
initial_value : ì´ˆê¸° ê°’
dtype : ë°˜í™˜ë˜ëŠ” Tensor íƒ€ì… name : í…ì„œì˜ ì´ë¦„
ìƒìˆ˜ í…ì„œ ìƒì„± ë° ìˆ˜ì‹ ì •ì˜
03
Example
import tensorflow as tf
tf.constant(value, dtype= None, shape= None, name= â€˜Constâ€™)
í…ì„œí”Œë¡œìš° ê¸°ì´ˆ ì‚¬ìš©ë²•
import tensorflow as tf
# ìƒìˆ˜ í…ì„œ ìƒì„±
a = tf.constant([1,0],dtype=tf.float32)
# ìˆ˜ì‹ ì •ì˜
def forward(x):
return W * x + b
ì •ì˜ëœ ìˆ˜ì‹ì„ í™œìš©í•œ ì—°ì‚°
03
Example
í…ì„œí”Œë¡œìš° ê¸°ì´ˆ ì‚¬ìš©ë²•
tf.Tensor(
[[1. 0.]
[1. 0.]], shape=(2, 2), dtype=float32)
Result
# í…ì„œ ê³„ì‚° ë° ì¶œë ¥
output = forward(a)
print(output)
Confidential all right reserved
í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
04
04 í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„ ìˆœì„œ
1. ë°ì´í„°ì…‹ ì¤€ë¹„í•˜ê¸°
2. ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬ì¶•í•˜ê¸°
3. ëª¨ë¸ í•™ìŠµì‹œí‚¤ê¸°
4. í‰ê°€ ë° ì˜ˆì¸¡í•˜ê¸°
04 í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
1. ë°ì´í„°ì…‹ ì¤€ë¹„í•˜ê¸° : Epochì™€ Batch
Epoch: í•œ ë²ˆì˜ epochëŠ” ì „ì²´ ë°ì´í„°ì…‹ì— ëŒ€í•´ í•œ ë²ˆ í•™ìŠµì„ ì™„ë£Œí•œ ìƒíƒœ
Batch: ë‚˜ëˆ ì§„ ë°ì´í„°ì…‹ (ë³´í†µ mini-batchë¼ê³  í‘œí˜„)
iterationëŠ” epochë¥¼ ë‚˜ëˆ„ì–´ì„œ ì‹¤í–‰í•˜ëŠ” íšŸìˆ˜ë¥¼ ì˜ë¯¸
Batch size
04
Epochì™€ Batch ì˜ˆì‹œ
Data set
1 Epoch
Ex) ì´ ë°ì´í„°ê°€ 1000ê°œ, Batch size = 100
â€¢ 1 iteration = 100ê°œ ë°ì´í„°ì— ëŒ€í•´ì„œ í•™ìŠµ
â€¢ 1 epoch = 100/Batch size = 10 iteration
í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
04
Example
data = np.random.sample((100,2))
labels = np.random.sample((100,1))
# numpy arrayë¡œë¶€í„° ë°ì´í„°ì…‹ ìƒì„±
dataset = tf.data.Dataset.from_tensor_slices((data, labels))
dataset = dataset.batch(32)
Dataset APIë¥¼ ì‚¬ìš©í•˜ì—¬ ë”¥ëŸ¬ë‹ ëª¨ë¸ìš© ë°ì´í„°ì…‹ì„ ìƒì„±
ë°ì´í„°ì…‹ ì¤€ë¹„í•˜ê¸° ì½”ë“œ ì˜ˆì‹œ
í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
04 í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
2. ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬ì¶•í•˜ê¸° : ê³ ìˆ˜ì¤€ API í™œìš©
í…ì„œí”Œë¡œìš°ì˜ íŒ¨í‚¤ì§€ë¡œ ì œê³µë˜ëŠ” ê³ ìˆ˜ì¤€ API
ë”¥ëŸ¬ë‹ ëª¨ë¸ì„ ê°„ë‹¨í•˜ê³  ë¹ ë¥´ê²Œ êµ¬í˜„ ê°€ëŠ¥
04 í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬ì¶•ì„ ìœ„í•œ Keras ë©”ì†Œë“œ(1)
ëª¨ë¸ í´ë˜ìŠ¤ ê°ì²´ ìƒì„±
ëª¨ë¸ì˜ ê° Layer êµ¬ì„±
â€¢ units : ë ˆì´ì–´ ì•ˆì˜ Nodeì˜ ìˆ˜
â€¢ activation : ì ìš©í•  activation í•¨ìˆ˜ ì„¤ì •
tf.keras.models.Sequential()
tf.keras.layers.Dense(units, activation)
04 í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
Input Layerì˜ ì…ë ¥ í˜•íƒœ ì§€ì •í•˜ê¸°
â€¦
Input Layer
â€¦
1 Hidden Layer
â€¦
N Hidden Layer Output Layer
â€¦ â€¦
â€¦
ì²« ë²ˆì§¸ ì¦‰, Input LayerëŠ” ì…ë ¥ í˜•íƒœì— ëŒ€í•œ ì •ë³´ë¥¼ í•„ìš”ë¡œ í•¨
input_shape / input_dim ì¸ì ì„¤ì •í•˜ê¸°
04 í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
Example
model = tf.keras.models.Sequential([
tf.keras.layers.Dense(10, input_dim=2, activation=â€˜sigmoidâ€™),
tf.keras.layers.Dense(10, activation=â€˜sigmoid'),
tf.keras.layers.Dense(1, activation='sigmoid'),
])
ëª¨ë¸ êµ¬ì¶•í•˜ê¸° ì½”ë“œ ì˜ˆì‹œ(1)
[model].add(tf.keras.layers.Dense(units, activation))
04 í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬ì¶•ì„ ìœ„í•œ Keras ë©”ì†Œë“œ(2)
ëª¨ë¸ì— Layer ì¶”ê°€í•˜ê¸°
â€¢ units : ë ˆì´ì–´ ì•ˆì˜ Nodeì˜ ìˆ˜
â€¢ activation : ì ìš©í•  activation í•¨ìˆ˜ ì„¤ì •
04 í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
Example
model = tf.keras.models.Sequential()
model.add(tf.keras.layers.Dense(10, input_dim=2, activation=â€˜sigmoidâ€™))
model.add(tf.keras.layers.Dense(10, activation=â€˜sigmoidâ€™))
model.add(tf.keras.layers.Dense(1, activation='sigmoidâ€™))
ëª¨ë¸ êµ¬ì¶•í•˜ê¸° ì½”ë“œ ì˜ˆì‹œ(2)
04 í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
3. ë”¥ëŸ¬ë‹ ëª¨ë¸ í•™ìŠµì‹œí‚¤ê¸° : Keras ë©”ì†Œë“œ
ëª¨ë¸ í•™ìŠµ ë°©ì‹ì„ ì„¤ì •í•˜ê¸° ìœ„í•œ í•¨ìˆ˜
[model].compile(optimizer, loss)
â€¢ optimizer : ëª¨ë¸ í•™ìŠµ ìµœì í™” ë°©ë²•
â€¢ loss : ì†ì‹¤ í•¨ìˆ˜ ì„¤ì •
ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ê¸° ìœ„í•œ í•¨ìˆ˜
[model].fit(x, y)
â€¢ x : í•™ìŠµ ë°ì´í„°
â€¢ y : í•™ìŠµ ë°ì´í„°ì˜ label
04 í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
Example
model.compile(loss='mean_squared_errorâ€™, optimizer=â€˜SGD')
model.fit(dataset, epochs=100)
ë”¥ëŸ¬ë‹ ëª¨ë¸ í•™ìŠµì‹œí‚¤ê¸° ì½”ë“œ ì˜ˆì‹œ
04 í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
4. í‰ê°€ ë° ì˜ˆì¸¡í•˜ê¸° : Keras ë©”ì†Œë“œ
ëª¨ë¸ì„ í‰ê°€í•˜ê¸° ìœ„í•œ ë©”ì†Œë“œ
[model].evaluate(x, y)
â€¢ x : í…ŒìŠ¤íŠ¸ ë°ì´í„°
â€¢ y : í…ŒìŠ¤íŠ¸ ë°ì´í„°ì˜ label
ëª¨ë¸ë¡œ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ í•¨ìˆ˜
[model].predict(x)
â€¢ x : ì˜ˆì¸¡í•˜ê³ ì í•˜ëŠ” ë°ì´í„°
04 í…ì„œí”Œë¡œìš°ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ êµ¬í˜„í•˜ê¸°
Example
# í…ŒìŠ¤íŠ¸ ë°ì´í„° ì¤€ë¹„í•˜ê¸°
dataset_test = tf.data.Dataset.from_tensor_slices((data_test, labels_test))
dataset_test = dataset.batch(32)
# ëª¨ë¸ í‰ê°€ ë° ì˜ˆì¸¡í•˜ê¸°
model.evaluate(dataset_test)
predicted_labels_test = model.predict(data_test)

